from django import forms
from .models import Project, Link, Subdomain

class ProjectName(forms.ModelForm):
    class Meta:
        model = Project
        fields = "__all__"

        def save(self,pk):
            
            # data = self.cleaned_data['subdomains']
            link = Link.objects.filter(id = pk)

            subdomain = Subdomain(link = link, )


            pass


class Links(forms.Form):
    links = forms.CharField(widget=forms.Textarea)

    def save(self, pk):
        data = self.cleaned_data['links']
        whole_link = data.split('\r\n')
       

        proj = Project.objects.get(id = pk)
        links = Link.objects.filter(project = proj)



        link_list = [str(link) for link in links]


        new_linklist = [link for link in whole_link if link not in link_list]


        for item in new_linklist:
            link = Link(project = proj, link = item)
            link.save()
            print('link kaydedildi')
            #Resullerin fonksiyon burda çalışacak sonucu subdomains save ile kaydedicek

            print(link.id)
            for item in ['wwww.google.com']:# Link yerine resullerin fonksiyonunun listesi gelicek
                linkobj = Link.objects.get(id = link.id)
                sub = Subdomain(link = linkobj, subdomain = item)
                sub.save()

class SubdomainForm(forms.Form):
    subdomains = forms.CharField(widget=forms.Textarea)
